!function(){"use strict";angular.module("autopoolIoApp",["ngMaterial","ngMessages","firebase","ngRoute"])}(),function(){"use strict";function a(a){return a()}angular.module("autopoolIoApp").factory("Auth",["$firebaseAuth",a])}(),function(){"use strict";function a(a,b){var c=this;c.auth=a,c.auth.$onAuthStateChanged(function(a){c.user=a,console.log("BadgeCtrl:",c.user)}),c.signOut=function(){c.auth.$signOut()},c.goToSettings=function(){b.path("/settings")},c.goToAdminSettings=function(){b.path("/admin")}}angular.module("autopoolIoApp").controller("BadgeCtrl",a),a.$inject=["Auth","$location"]}(),function(){"use strict";function a(a,b){a.$on("$routeChangeError",function(a,c,d,e){"AUTH_REQUIRED"===e&&b.path("/home")})}angular.module("autopoolIoApp").run(["$rootScope","$location",a])}(),function(){function a(a,b,c){a.when("/home",{controller:"HomeCtrl as home",templateUrl:"views/home.html"}).when("/onboard",{controller:"OnboardCtrl as onboard",templateUrl:"views/onboard.html",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn()}]}}).when("/group",{controller:"GroupCtrl as group",templateUrl:"views/group.html",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn()}]}}).when("/ride",{controller:"RideCtrl as ride",templateUrl:"views/ride.html",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn()}]}}).when("/settings",{controller:"SettingsCtrl as settings",templateUrl:"views/settings.html",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn()}]}}).when("/admin",{controller:"SettingsAdminCtrl as admin",templateUrl:"views/admin.html",resolve:{currentAuth:["Auth",function(a){return a.$requireSignIn()}]}}).otherwise({controller:"HomeCtrl as home",templateUrl:"views/home.html"}),b.html5Mode(!0),c.theme("default").primaryPalette("teal").accentPalette("light-green").warnPalette("deep-orange")}angular.module("autopoolIoApp").config(["$routeProvider","$locationProvider","$mdThemingProvider",a])}(),function(){"use strict";function a(a,b){var c={};return c.saveNewUser=function(b,c,d,e,f){var g=firebase.database().ref(),h=g.child("users").child(b),i=a(h);return i.displayName=c,i.googleEmail=d,i.photoURL=e,i.googleUid=f,i.startPoint=null,i.endPoint=null,i.phoneNumber=null,i.role={type:null,distances:null},i.createDate=firebase.database.ServerValue.TIMESTAMP,i.modDate=firebase.database.ServerValue.TIMESTAMP,i.isAdmin=!1,i.isAuth=!1,i.$save().then(function(){console.log("New user saved:",i.displayName,i.$id)}).catch(function(a){console.error("Error:",a)}),i},c.getUser=function(b){var c=firebase.database().ref().child("users");return a(c.child(b))},c.getUsers=function(){var a=firebase.database().ref().child("users");return b(a)},c}angular.module("autopoolIoApp").factory("Data",["$firebaseObject","$firebaseArray",a])}(),function(){"use strict";var a={apiKey:"AIzaSyBqyaR4kQ_yVKDp7aXe0WcOfbMw4BHQLb8",authDomain:"autopool-io.firebaseapp.com",databaseURL:"https://autopool-io.firebaseio.com",storageBucket:"autopool-io.appspot.com"};firebase.initializeApp(a)}(),function(){"use strict";function a(a,b,c,d,e){var f=this;f.map=c.map,f.selectedUsers=[],f.currentAuth=b,f.user=a.getUser(b.uid),f.users=a.getUsers(),f.users.$loaded().then(function(a){console.log("users:",a)}),f.selection=function(){return d(f.users,{selected:!0})},e.$watch("group.users|filter:{selected:true}",function(a){f.selectedUsers=a.map(function(a){return a}),f.makeMarkers()},!0),f.test=function(){console.log("selected users:",f.selectedUsers)},f.markers=[],f.makeMarkers=function(){console.log("selected users:",f.selectedUsers),console.log("doing something"),f.markers=[];for(var a=0;a<f.selectedUsers.length;a++){var b=new google.maps.LatLng(f.selectedUsers[a].startPointLat,f.selectedUsers[a].startPointLong);console.log(b),f.marker=new google.maps.Marker({map:f.map,animation:google.maps.Animation.DROP,position:b}),f.marker.setVisible(!0),f.markers.push(f.marker)}},f.calculateRoute=function(){for(var a=[],b=0;b<f.selectedUsers.length;b++)a.push({location:f.selectedUsers[b].startPoint,stopover:!0});var c=new google.maps.DirectionsRenderer({map:f.map}),d={destination:f.user.endPoint,origin:f.user.startPoint,waypoints:a,optimizeWaypoints:!0,travelMode:"DRIVING"},e=new google.maps.DirectionsService;e.route(d,function(a,b){"OK"==b&&(console.log(a),c.setDirections(a))})}}angular.module("autopoolIoApp").controller("GroupCtrl",a),a.$inject=["Data","currentAuth","$rootScope","filterFilter","$scope"]}(),function(){"use strict";function a(a,b,c,d){var e=this;b.$onAuthStateChanged(function(a){a&&c.path("/onboard")}),e.loginUser=function(){e.message=null,e.error=null,b.$signInWithPopup("google").then(function(a){e.something=d.getUser(a.user.uid),e.something.$loaded().then(function(b){b.displayName?console.log("user exists!"):(console.log("user does not exist!"),d.saveNewUser(a.user.uid,a.user.displayName,a.user.email,a.user.photoURL,a.user.providerData[0].uid))}),c.path("/onboard")}).catch(function(a){console.log("Authentication failed:",a)})}}angular.module("autopoolIoApp").controller("HomeCtrl",a),a.$inject=["$http","Auth","$location","Data"]}(),function(){"use strict";function a(a,b){function c(a,b,c){b.setPosition(c),b.setContent(a?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation.")}var d=new google.maps.Map(document.getElementById("map"),{center:{lat:44.9778,lng:-93.265},zoom:10,disableDefaultUI:!0,styles:[{featureType:"road",elementType:"geometry",stylers:[{color:"#558B2F"}]},{featureType:"road",elementType:"labels",stylers:[{saturation:-100}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0D47A1"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"all",stylers:[{saturation:-50}]}]});navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){var b={lat:a.coords.latitude,lng:a.coords.longitude};d.setCenter(b)},function(){c(!0,infoWindow,d.getCenter())}):c(!1,infoWindow,d.getCenter()),b.map=d}angular.module("autopoolIoApp").controller("MapCtrl",a),a.$inject=["Data","$rootScope"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){j.map=f.map,k=new google.maps.places.Autocomplete(document.getElementById("autocomplete1"),{types:["geocode"]}),l=new google.maps.places.Autocomplete(document.getElementById("autocomplete2"),{types:["geocode"]}),j.marker1=new google.maps.Marker({map:j.map,animation:google.maps.Animation.DROP,anchorPoint:new google.maps.Point(0,(-29)),icon:"/assets/vendors/home.svg"}),j.marker2=new google.maps.Marker({map:j.map,animation:google.maps.Animation.DROP,anchorPoint:new google.maps.Point(0,(-29)),icon:"/assets/vendors/work.svg"}),k.addListener("place_changed",h),l.addListener("place_changed",i)}function h(){j.marker1.setVisible(!1);var a=k.getPlace();j.marker1.setPosition(a.geometry.location),j.marker1.setVisible(!0),j.user.startPoint=a.formatted_address,j.user.startPointPlaceID=a.place_id,j.user.startPointLat=a.geometry.location.lat(),j.user.startPointLong=a.geometry.location.lng()}function i(){j.marker2.setVisible(!1);var a=l.getPlace();j.marker2.setPosition(a.geometry.location),j.marker2.setVisible(!0),j.user.endPoint=a.formatted_address,j.user.endPointPlaceID=a.place_id,j.user.endPointLat=a.geometry.location.lat(),j.user.endPointLong=a.geometry.location.lng()}var j=this;j.user=e.getUser(b.uid),j.user.$loaded().then(function(){j.user.startPoint&&j.user.startPointPlaceID&&j.user.endPoint&&j.user.endPointPlaceID&&j.user.phoneNumber&&j.user.role&&(console.log("User already onboarded, redirecting..."),d.path("/group"))}),j.user.startPoint="",j.user.startPointPlaceID="",j.user.endPoint="",j.user.endPointPlaceID="",j.user.phoneNumber="",j.user.role="",j.submitOnboardInfo=function(){j.user.modDate=firebase.database.ServerValue.TIMESTAMP,j.user.$save().then(function(){console.log("Onboard info saved:",j.user.displayName,j.user.$id)}).catch(function(a){console.error("Error:",a)})},c.$onAuthStateChanged(function(a){a||d.path("/home")});var k,l;g(),j.geolocate=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){var b={lat:a.coords.latitude,lng:a.coords.longitude},c=new google.maps.Circle({center:b,radius:a.coords.accuracy});k.setBounds(c.getBounds()),l.setBounds(c.getBounds())})}}angular.module("autopoolIoApp").controller("OnboardCtrl",a),a.$inject=["$http","currentAuth","Auth","$location","Data","$rootScope"]}(),function(){"use strict";angular.module("autopoolIoApp").controller("SettingsAdminCtrl",function(){console.log("Hi!")})}(),function(){"use strict";angular.module("autopoolIoApp").controller("SettingsCtrl",function(){console.log("Hi!")})}();